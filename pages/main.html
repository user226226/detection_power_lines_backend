<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="/styles/main.css">
    <title>Обнаружение объектов ЛЭП</title>
  </head>
  <body>
    <div>
        <h1 class="mb-3">Обнаружение объектов ЛЭП</h1>
    </div>
    
    <div class="flex-container">

      <div class="select-image">
        <h2>Исходное изображение</h2>
        <div class="image">
          <img id="input" width="200"/>
        </div> 
        <div class="input">
          <label>
            <input type="file" src="images/select_image.jpg" accept="image/*" onchange="loadFile(event)", enctype="multipart/form-data">
            Загрузить изображение
          </label>
        </div>
      </div>

      <div class="select-image">
        <h2>Результат</h2>
        <div class="image">
          <img id="input" src="images/result_image.jpg", onerror="this.style.display='none'"/>
        </div>
        <input class="input" type="button" value="Получить результат" onclick="uploadFile(event)">
      </div>
    </div>
    <div id="results"></div>

    <script>
        var img;
        var loadFile = function(event) {
            var image = document.getElementById('input');
            img = event.target.files[0]
            image.src=URL.createObjectURL(img);
        };

        var uploadFile = function(event) {
          var formData = new FormData();
          formData.append('file', img);
            fetch('/image', {
              method: 'POST',
              body: formData,
            })
            .then(response => {
              console.log(response)
            })
            .catch(error => {
              console.error(error);
            });
          const resultDiv = document.getElementById("results")
          while (resultDiv && resultDiv.firstChild) {
            resultDiv.removeChild(resultDiv.firstChild);
          }
          const lst = ["lol", "kek", "cheburek", "ahaha", "hehe"]
          let newDiv, newContent
          for(let el of lst){
            newDiv = document.createElement("div")
            newDiv.className = 'info'
            newContent = document.createTextNode(el)
            newDiv.appendChild(newContent)
            resultDiv.appendChild(newDiv)
          }
        }
    </script>
  </body>
</html>